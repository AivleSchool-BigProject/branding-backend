version: 0.2

phases:
  install:
    runtime-versions:
      java: corretto17

  pre_build:
    commands:
      - echo "PWD=$(pwd)"
      - ls -la
      - chmod +x gradlew

  build:
    commands:
      - ./gradlew clean build -x test
      - echo "=== build/libs 확인 ==="
      - ls -la build/libs
      - JAR_PATH=$(ls build/libs/*.jar | grep -v plain | head -n 1)
      - echo "Selected jar: $JAR_PATH"
      - cp "$JAR_PATH" app.jar
      - ls -la app.jar

artifacts:
  base-directory: .
  files:
    - app.jar